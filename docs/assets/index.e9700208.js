import{S as H,i as O,s as I,e as v,t as y,a as C,b,c as x,d as c,f as P,n as k,g as $,h as T,r as R,o as U,j as V,l as X,k as Y,m as Z,p as tt,q as et,u as nt,v as at,w as st,x as rt,y as ot,z as lt,A as S,B as q,C as M,D as A,E as B,F as z,G as it}from"./vendor.87cc8faf.js";const ct=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const e of a)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const e={};return a.integrity&&(e.integrity=a.integrity),a.referrerpolicy&&(e.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?e.credentials="include":a.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(a){if(a.ep)return;a.ep=!0;const e=r(a);fetch(a.href,e)}};ct();var ut="/west-madison/assets/madison-house.2ccfa63b.png";function mt(s){let t,r,o,a,e,l,u,m,i,_,g,d;return{c(){t=v("div"),r=v("h2"),o=y(s[1]),a=C(),e=v("p"),l=y("avg: "),u=y(s[3]),m=C(),i=v("span"),_=y(s[0]),g=C(),d=v("div"),b(r,"class","svelte-yu3l5e"),b(i,"class","units svelte-yu3l5e"),b(e,"class","svelte-yu3l5e"),b(d,"class","line-chart svelte-yu3l5e"),b(t,"class","container svelte-yu3l5e")},m(f,h){x(f,t,h),c(t,r),c(r,o),c(t,a),c(t,e),c(e,l),c(e,u),c(e,m),c(e,i),c(i,_),c(t,g),c(t,d),s[5](d)},p(f,[h]){h&2&&P(o,f[1]),h&1&&P(_,f[0])},i:k,o:k,d(f){f&&$(t),s[5](null)}}}function ft(s,t){const r=Math.pow(10,t);return Math.round(s*r)/r}const pt=20,W=30,D=30,F=40,dt={temp:[60,80],co2:[300,1e3],humidity:[0,80]},_t=at;function gt(s,t,r){let o,{unit:a}=t,{data:e}=t,{name:l}=t;const u=e.map(n=>({val:n[l],time:n.time})),m=u.length,i=ft(u.reduce((n,p)=>n+p.val/m,0),1),[_,g]=T(e,n=>n[l]),d=dt[l];d[0]>_&&(d[0]=_),d[1]<g&&(d[1]=g);const f=T(e,n=>n.time);R(m),U(()=>{const n=o.offsetWidth,p=o.offsetHeight,j=V(f,[F,n-W]).nice(),E=X(d,[p-D,pt]),K=Y(j).ticks(8).tickSizeOuter(0),J=Z(E).ticks(p/40),Q=tt().curve(_t).x(w=>j(w.time)).y(w=>E(w.val)),L=et("svg").attr("width",n).attr("height",p).attr("viewBox",[0,0,n,p]).attr("style","max-width: 100%; height: auto; height: intrinsic;");L.append("g").attr("transform",`translate(0,${p-D})`).call(K),L.append("g").attr("transform",`translate(${F},0)`).call(J).call(w=>w.select(".domain").remove()).call(w=>w.selectAll(".tick line").clone().attr("x2",n-F-W).attr("stroke-opacity",.1)).call(w=>w.append("text").attr("x",-F).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(a)),L.append("path").attr("fill","none").attr("stroke","currentColor").attr("stroke-width",1.5).attr("stroke-opacity",.65).attr("d",Q(u)),o.append(L.node())});function h(n){nt[n?"unshift":"push"](()=>{o=n,r(2,o)})}return s.$$set=n=>{"unit"in n&&r(0,a=n.unit),"data"in n&&r(4,e=n.data),"name"in n&&r(1,l=n.name)},[a,l,o,i,e,h]}class N extends H{constructor(t){super();O(this,t,gt,mt,I,{unit:0,data:4,name:1})}}function ht(s){let t,r,o=s[3].message+"",a;return{c(){t=v("p"),r=y("Something went wrong: "),a=y(o)},m(e,l){x(e,t,l),c(t,r),c(t,a)},p:k,i:k,o:k,d(e){e&&$(t)}}}function vt(s){let t,r,o=G(s[2][0].time,!0)+"",a,e,l=G(wt(s[2]).time)+"",u,m,i,_,g,d,f,h;return i=new N({props:{data:s[2],name:"co2",unit:"ppm"}}),g=new N({props:{data:s[2],name:"temp",unit:"degrees"}}),f=new N({props:{data:s[2],name:"humidity",unit:"%"}}),{c(){t=v("h3"),r=y("Time range: "),a=y(o),e=y(" - "),u=y(l),m=C(),M(i.$$.fragment),_=C(),M(g.$$.fragment),d=C(),M(f.$$.fragment)},m(n,p){x(n,t,p),c(t,r),c(t,a),c(t,e),c(t,u),x(n,m,p),A(i,n,p),x(n,_,p),A(g,n,p),x(n,d,p),A(f,n,p),h=!0},p:k,i(n){h||(S(i.$$.fragment,n),S(g.$$.fragment,n),S(f.$$.fragment,n),h=!0)},o(n){q(i.$$.fragment,n),q(g.$$.fragment,n),q(f.$$.fragment,n),h=!1},d(n){n&&$(t),n&&$(m),B(i,n),n&&$(_),B(g,n),n&&$(d),B(f,n)}}}function yt(s){let t;return{c(){t=v("p"),t.textContent="Fetching data from office raspberry pi..."},m(r,o){x(r,t,o)},p:k,i:k,o:k,d(r){r&&$(t)}}}function bt(s){let t,r,o={ctx:s,current:null,token:null,hasCatch:!0,pending:yt,then:vt,catch:ht,value:2,error:3,blocks:[,,,]};return rt(s[0],o),{c(){t=ot(),o.block.c()},m(a,e){x(a,t,e),o.block.m(a,o.anchor=e),o.mount=()=>t.parentNode,o.anchor=t,r=!0},p(a,[e]){s=a,lt(o,s,e)},i(a){r||(S(o.block),r=!0)},o(a){for(let e=0;e<3;e+=1){const l=o.blocks[e];q(l)}r=!1},d(a){a&&$(t),o.block.d(a),o.token=null,o=null}}}function kt(s){return s*(9/5)+32}function wt(s){return s[s.length-1]}function G(s,t=!1){return t?z("%a %b %e @ %I:%M %p")(s):z("%I:%M %p")(s)}const xt=st("%m/%d/%y %H:%M:%S"),$t=1e3;function Ct(s){return[(async()=>(await(await fetch(`http://67.205.131.141/data?nlines=${$t}`)).json()).readings.map(e=>{const l=xt(e.time);if(l===null)return null;l.setHours(l.getHours()-5);const u=kt(e.temp),m=e.humidity,i=e.co2;return{time:l,temp:u,humidity:m,co2:i}}).filter(e=>e!==null))()]}class St extends H{constructor(t){super();O(this,t,Ct,bt,I,{})}}function qt(s){let t,r,o,a,e,l,u,m;return u=new St({}),{c(){t=v("main"),r=v("img"),a=C(),e=v("h1"),e.textContent="West Madison HomeBase",l=C(),M(u.$$.fragment),it(r.src,o=ut)||b(r,"src",o),b(r,"alt","Svelte Logo"),b(r,"class","svelte-1epmnvv"),b(e,"class","svelte-1epmnvv"),b(t,"class","svelte-1epmnvv")},m(i,_){x(i,t,_),c(t,r),c(t,a),c(t,e),c(t,l),A(u,t,null),m=!0},p:k,i(i){m||(S(u.$$.fragment,i),m=!0)},o(i){q(u.$$.fragment,i),m=!1},d(i){i&&$(t),B(u)}}}class Lt extends H{constructor(t){super();O(this,t,null,qt,I,{})}}new Lt({target:document.getElementById("app")});
