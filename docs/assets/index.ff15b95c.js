import{S as z,i as P,s as T,e as g,t as C,a as S,b as w,c as L,d as i,f as A,n as N,g as q,h as G,r as et,o as nt,j as at,l as st,k as rt,m as lt,p as ot,q as it,u as ut,v as mt,w as J,x as ct,y as K,z as R,A as U,B as ft,C as B,D as F,E as pt,F as O,G as E,H as j,I as V,J as _t}from"./vendor.c24e01c4.js";const dt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}};dt();var ht="/west-madison/assets/madison-house.2ccfa63b.png";function vt(e){let t,n,l,r,a,u,f,d,p,h,b,$,_,v,o,s,k;return{c(){t=g("div"),n=g("h2"),l=C(e[1]),r=C(" = "),a=C(e[4]),u=S(),f=g("span"),d=C(e[0]),p=S(),h=g("p"),b=C("avg: "),$=C(e[3]),_=S(),v=g("span"),o=C(e[0]),s=S(),k=g("div"),w(f,"class","units svelte-yu3l5e"),w(n,"class","svelte-yu3l5e"),w(v,"class","units svelte-yu3l5e"),w(h,"class","svelte-yu3l5e"),w(k,"class","line-chart svelte-yu3l5e"),w(t,"class","container svelte-yu3l5e")},m(c,m){L(c,t,m),i(t,n),i(n,l),i(n,r),i(n,a),i(n,u),i(n,f),i(f,d),i(t,p),i(t,h),i(h,b),i(h,$),i(h,_),i(h,v),i(v,o),i(t,s),i(t,k),e[6](k)},p(c,[m]){m&2&&A(l,c[1]),m&1&&A(d,c[0]),m&1&&A(o,c[0])},i:N,o:N,d(c){c&&q(t),e[6](null)}}}function gt(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}function Q(e,t=1){const n=e.length;return gt(e.reduce((l,r)=>l+r/n,0),1)}const yt=20,X=30,Y=30,x=40,bt={temp:[60,80],co2:[300,1e3],humidity:[0,80]},kt=mt;function wt(e,t,n){let l,{unit:r}=t,{data:a}=t,{name:u}=t;const f=a.map(s=>({val:s[u],time:s.time})),d=f.length,p=Q(f.map(s=>s.val)),h=Q(f.slice(10).map(s=>s.val)),[b,$]=G(a,s=>s[u]),_=bt[u];_[0]>b&&(_[0]=b),_[1]<$&&(_[1]=$);const v=G(a,s=>s.time);et(d),nt(()=>{const s=l.offsetWidth,k=l.offsetHeight,c=at(v,[x,s-X]).nice(),m=st(_,[k-Y,yt]),y=rt(c).ticks(8).tickSizeOuter(0),H=lt(m).ticks(k/40),tt=ot().curve(kt).x(M=>c(M.time)).y(M=>m(M.val)),I=it("svg").attr("width",s).attr("height",k).attr("viewBox",[0,0,s,k]).attr("style","max-width: 100%; height: auto; height: intrinsic;");I.append("g").attr("transform",`translate(0,${k-Y})`).call(y),I.append("g").attr("transform",`translate(${x},0)`).call(H).call(M=>M.select(".domain").remove()).call(M=>M.selectAll(".tick line").clone().attr("x2",s-x-X).attr("stroke-opacity",.1)).call(M=>M.append("text").attr("x",-x).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(r)),I.append("path").attr("fill","none").attr("stroke","currentColor").attr("stroke-width",1.5).attr("stroke-opacity",.65).attr("d",tt(f)),l.append(I.node())});function o(s){ut[s?"unshift":"push"](()=>{l=s,n(2,l)})}return e.$$set=s=>{"unit"in s&&n(0,r=s.unit),"data"in s&&n(5,a=s.data),"name"in s&&n(1,u=s.name)},[r,u,l,p,h,a,o]}class W extends z{constructor(t){super();P(this,t,wt,vt,T,{unit:0,data:5,name:1})}}function Ct(e){let t,n,l=e[6].message+"",r;return{c(){t=g("p"),n=C("Something went wrong: "),r=C(l)},m(a,u){L(a,t,u),i(t,n),i(t,r)},p(a,u){u&4&&l!==(l=a[6].message+"")&&A(r,l)},i:N,o:N,d(a){a&&q(t)}}}function $t(e){let t,n,l=D(Z(e[5]).time)+"",r,a,u=D(e[5][0].time,!0)+"",f,d,p,h,b,$,_,v;return p=new W({props:{data:e[5],name:"co2",unit:"ppm"}}),b=new W({props:{data:e[5],name:"temp",unit:"degrees"}}),_=new W({props:{data:e[5],name:"humidity",unit:"%"}}),{c(){t=g("h3"),n=C("Time range: "),r=C(l),a=C(" - "),f=C(u),d=S(),O(p.$$.fragment),h=S(),O(b.$$.fragment),$=S(),O(_.$$.fragment)},m(o,s){L(o,t,s),i(t,n),i(t,r),i(t,a),i(t,f),L(o,d,s),E(p,o,s),L(o,h,s),E(b,o,s),L(o,$,s),E(_,o,s),v=!0},p(o,s){(!v||s&4)&&l!==(l=D(Z(o[5]).time)+"")&&A(r,l),(!v||s&4)&&u!==(u=D(o[5][0].time,!0)+"")&&A(f,u);const k={};s&4&&(k.data=o[5]),p.$set(k);const c={};s&4&&(c.data=o[5]),b.$set(c);const m={};s&4&&(m.data=o[5]),_.$set(m)},i(o){v||(B(p.$$.fragment,o),B(b.$$.fragment,o),B(_.$$.fragment,o),v=!0)},o(o){F(p.$$.fragment,o),F(b.$$.fragment,o),F(_.$$.fragment,o),v=!1},d(o){o&&q(t),o&&q(d),j(p,o),o&&q(h),j(b,o),o&&q($),j(_,o)}}}function St(e){let t;return{c(){t=g("p"),t.textContent="Fetching data from office raspberry pi..."},m(n,l){L(n,t,l)},p:N,i:N,o:N,d(n){n&&q(t)}}}function Lt(e){let t,n,l,r,a,u,f,d,p,h,b,$,_,v,o,s,k,c={ctx:e,current:null,token:null,hasCatch:!0,pending:St,then:$t,catch:Ct,value:5,error:6,blocks:[,,,]};return J(v=e[2],c),{c(){t=g("form"),n=g("label"),l=g("span"),l.textContent="Number of hours to pull:",r=S(),a=g("input"),u=S(),f=g("button"),f.textContent="Update",d=S(),p=g("p"),h=C(e[0]),b=C(" hours"),$=S(),_=ct(),c.block.c(),w(a,"type","number"),w(a,"min","1"),w(a,"max","24"),w(f,"type","submit"),w(n,"class","svelte-n92o7v")},m(m,y){L(m,t,y),i(t,n),i(n,l),i(n,r),i(n,a),K(a,e[1]),i(n,u),i(n,f),L(m,d,y),L(m,p,y),i(p,h),i(p,b),L(m,$,y),L(m,_,y),c.block.m(m,c.anchor=y),c.mount=()=>_.parentNode,c.anchor=_,o=!0,s||(k=[R(a,"input",e[4]),R(t,"submit",e[3])],s=!0)},p(m,[y]){e=m,y&2&&U(a.value)!==e[1]&&K(a,e[1]),(!o||y&1)&&A(h,e[0]),c.ctx=e,y&4&&v!==(v=e[2])&&J(v,c)||ft(c,e,y)},i(m){o||(B(c.block),o=!0)},o(m){for(let y=0;y<3;y+=1){const H=c.blocks[y];F(H)}o=!1},d(m){m&&q(t),m&&q(d),m&&q(p),m&&q($),m&&q(_),c.block.d(m),c.token=null,c=null,s=!1,pt(k)}}}function qt(e){return e*(9/5)+32}function Z(e){return e[e.length-1]}function D(e,t=!1){return t?V("%a %b %e @ %I:%M %p")(e):V("%I:%M %p")(e)}function Mt(e){const[t,n,l,r]=e.split(",").map(Number);if(!(t&&n&&l&&r))throw console.error("Can't parse line of data",e),new Error("Can't parse line of data");return{time:new Date(t*1e3),co2:n,temp:qt(Number(l)),humidity:r}}const Nt=async e=>(await(await fetch(`https://wmadisonatelier.com/data/${e}`)).json()).map(Mt);function At(e,t,n){let l=6,r=l,a;function u(d){d.preventDefault(),n(0,r=l)}function f(){l=U(this.value),n(1,l)}return e.$$.update=()=>{e.$$.dirty&1&&n(2,a=Nt(r))},[r,l,a,u,f]}class Bt extends z{constructor(t){super();P(this,t,At,Lt,T,{})}}function Ft(e){let t,n,l,r,a,u,f,d;return f=new Bt({}),{c(){t=g("main"),n=g("img"),r=S(),a=g("h1"),a.textContent="West Madison HomeBase",u=S(),O(f.$$.fragment),_t(n.src,l=ht)||w(n,"src",l),w(n,"alt","Svelte Logo"),w(n,"class","svelte-1epmnvv"),w(a,"class","svelte-1epmnvv"),w(t,"class","svelte-1epmnvv")},m(p,h){L(p,t,h),i(t,n),i(t,r),i(t,a),i(t,u),E(f,t,null),d=!0},p:N,i(p){d||(B(f.$$.fragment,p),d=!0)},o(p){F(f.$$.fragment,p),d=!1},d(p){p&&q(t),j(f)}}}class It extends z{constructor(t){super();P(this,t,null,Ft,T,{})}}new It({target:document.getElementById("app")});
