import{S as N,i as j,s as E,e as h,t as _,a as C,b as y,c as S,d as c,f as P,n as w,g as q,h as z,r as U,o as X,j as Y,l as Z,k as tt,m as et,p as nt,q as at,u as st,v as rt,w as lt,x as ot,y as it,z as ct,A as M,B as A,C as F,D as H,E as O,F as W,G as ut}from"./vendor.87cc8faf.js";const mt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerpolicy&&(e.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?e.credentials="include":n.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(n){if(n.ep)return;n.ep=!0;const e=a(n);fetch(n.href,e)}};mt();var ft="/west-madison/assets/madison-house.2ccfa63b.png";function pt(s){let t,a,r,n,e,i,u,f,m,p,g,$,d,v,o,l,b;return{c(){t=h("div"),a=h("h2"),r=_(s[1]),n=_(" = "),e=_(s[4]),i=C(),u=h("span"),f=_(s[0]),m=C(),p=h("p"),g=_("avg: "),$=_(s[3]),d=C(),v=h("span"),o=_(s[0]),l=C(),b=h("div"),y(u,"class","units svelte-yu3l5e"),y(a,"class","svelte-yu3l5e"),y(v,"class","units svelte-yu3l5e"),y(p,"class","svelte-yu3l5e"),y(b,"class","line-chart svelte-yu3l5e"),y(t,"class","container svelte-yu3l5e")},m(k,L){S(k,t,L),c(t,a),c(a,r),c(a,n),c(a,e),c(a,i),c(a,u),c(u,f),c(t,m),c(t,p),c(p,g),c(p,$),c(p,d),c(p,v),c(v,o),c(t,l),c(t,b),s[6](b)},p(k,[L]){L&2&&P(r,k[1]),L&1&&P(f,k[0]),L&1&&P(o,k[0])},i:w,o:w,d(k){k&&q(t),s[6](null)}}}function dt(s,t){const a=Math.pow(10,t);return Math.round(s*a)/a}function D(s,t=1){const a=s.length;return dt(s.reduce((r,n)=>r+n/a,0),1)}const _t=20,G=30,K=30,I=40,gt={temp:[60,80],co2:[300,1e3],humidity:[0,80]},ht=rt;function vt(s,t,a){let r,{unit:n}=t,{data:e}=t,{name:i}=t;const u=e.map(l=>({val:l[i],time:l.time})),f=u.length,m=D(u.map(l=>l.val)),p=D(u.slice(-10).map(l=>l.val)),[g,$]=z(e,l=>l[i]),d=gt[i];d[0]>g&&(d[0]=g),d[1]<$&&(d[1]=$);const v=z(e,l=>l.time);U(f),X(()=>{const l=r.offsetWidth,b=r.offsetHeight,k=Y(v,[I,l-G]).nice(),L=Z(d,[b-K,_t]),J=tt(k).ticks(8).tickSizeOuter(0),Q=et(L).ticks(b/40),R=nt().curve(ht).x(x=>k(x.time)).y(x=>L(x.val)),B=at("svg").attr("width",l).attr("height",b).attr("viewBox",[0,0,l,b]).attr("style","max-width: 100%; height: auto; height: intrinsic;");B.append("g").attr("transform",`translate(0,${b-K})`).call(J),B.append("g").attr("transform",`translate(${I},0)`).call(Q).call(x=>x.select(".domain").remove()).call(x=>x.selectAll(".tick line").clone().attr("x2",l-I-G).attr("stroke-opacity",.1)).call(x=>x.append("text").attr("x",-I).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(n)),B.append("path").attr("fill","none").attr("stroke","currentColor").attr("stroke-width",1.5).attr("stroke-opacity",.65).attr("d",R(u)),r.append(B.node())});function o(l){st[l?"unshift":"push"](()=>{r=l,a(2,r)})}return s.$$set=l=>{"unit"in l&&a(0,n=l.unit),"data"in l&&a(5,e=l.data),"name"in l&&a(1,i=l.name)},[n,i,r,m,p,e,o]}class T extends N{constructor(t){super();j(this,t,vt,pt,E,{unit:0,data:5,name:1})}}function yt(s){let t,a,r=s[3].message+"",n;return{c(){t=h("p"),a=_("Something went wrong: "),n=_(r)},m(e,i){S(e,t,i),c(t,a),c(t,n)},p:w,i:w,o:w,d(e){e&&q(t)}}}function bt(s){let t,a,r=V(s[2][0].time,!0)+"",n,e,i=V(xt(s[2]).time)+"",u,f,m,p,g,$,d,v;return m=new T({props:{data:s[2],name:"co2",unit:"ppm"}}),g=new T({props:{data:s[2],name:"temp",unit:"degrees"}}),d=new T({props:{data:s[2],name:"humidity",unit:"%"}}),{c(){t=h("h3"),a=_("Time range: "),n=_(r),e=_(" - "),u=_(i),f=C(),F(m.$$.fragment),p=C(),F(g.$$.fragment),$=C(),F(d.$$.fragment)},m(o,l){S(o,t,l),c(t,a),c(t,n),c(t,e),c(t,u),S(o,f,l),H(m,o,l),S(o,p,l),H(g,o,l),S(o,$,l),H(d,o,l),v=!0},p:w,i(o){v||(M(m.$$.fragment,o),M(g.$$.fragment,o),M(d.$$.fragment,o),v=!0)},o(o){A(m.$$.fragment,o),A(g.$$.fragment,o),A(d.$$.fragment,o),v=!1},d(o){o&&q(t),o&&q(f),O(m,o),o&&q(p),O(g,o),o&&q($),O(d,o)}}}function kt(s){let t;return{c(){t=h("p"),t.textContent="Fetching data from office raspberry pi..."},m(a,r){S(a,t,r)},p:w,i:w,o:w,d(a){a&&q(t)}}}function wt(s){let t,a,r={ctx:s,current:null,token:null,hasCatch:!0,pending:kt,then:bt,catch:yt,value:2,error:3,blocks:[,,,]};return ot(s[0],r),{c(){t=it(),r.block.c()},m(n,e){S(n,t,e),r.block.m(n,r.anchor=e),r.mount=()=>t.parentNode,r.anchor=t,a=!0},p(n,[e]){s=n,ct(r,s,e)},i(n){a||(M(r.block),a=!0)},o(n){for(let e=0;e<3;e+=1){const i=r.blocks[e];A(i)}a=!1},d(n){n&&q(t),r.block.d(n),r.token=null,r=null}}}function $t(s){return s*(9/5)+32}function xt(s){return s[s.length-1]}function V(s,t=!1){return t?W("%a %b %e @ %I:%M %p")(s):W("%I:%M %p")(s)}const Ct=lt("%m/%d/%y %H:%M:%S"),St=7e3;function qt(s){return[(async()=>(await(await fetch(`http://wmadisonatelier.com/data?nlines=${St}`)).json()).readings.map(e=>{const i=Ct(e.time);if(i===null)return null;i.setHours(i.getHours()-5);const u=$t(e.temp),f=e.humidity,m=e.co2;return{time:i,temp:u,humidity:f,co2:m}}).filter(e=>e!==null))()]}class Lt extends N{constructor(t){super();j(this,t,qt,wt,E,{})}}function Mt(s){let t,a,r,n,e,i,u,f;return u=new Lt({}),{c(){t=h("main"),a=h("img"),n=C(),e=h("h1"),e.textContent="West Madison HomeBase",i=C(),F(u.$$.fragment),ut(a.src,r=ft)||y(a,"src",r),y(a,"alt","Svelte Logo"),y(a,"class","svelte-1epmnvv"),y(e,"class","svelte-1epmnvv"),y(t,"class","svelte-1epmnvv")},m(m,p){S(m,t,p),c(t,a),c(t,n),c(t,e),c(t,i),H(u,t,null),f=!0},p:w,i(m){f||(M(u.$$.fragment,m),f=!0)},o(m){A(u.$$.fragment,m),f=!1},d(m){m&&q(t),O(u)}}}class At extends N{constructor(t){super();j(this,t,null,Mt,E,{})}}new At({target:document.getElementById("app")});
