import{f as mt,S as G,i as J,s as R,e as v,t as C,a as $,b,c as w,d as f,g as I,n as L,h as x,m as ft,j as pt,k as _t,l as dt,o as X,r as ht,p as vt,q as gt,u as yt,v as bt,w as kt,x as wt,y as xt,z as Ct,A as $t,B as Y,C as qt,D as Z,E as tt,F as et,G as Lt,H as A,I as M,J as St,K as Nt,L as F,M as E,N as j,O as nt,P as It}from"./vendor.0f25e4a9.js";const At=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};At();var Mt="/west-madison/assets/madison-house.2ccfa63b.png";function Ot(e){let t,n,r,o,s,i,c,d,l,h;return{c(){t=v("div"),n=v("h2"),r=C(e[1]),o=C(" : "),s=C(e[3]),i=$(),c=v("span"),d=C(e[0]),l=$(),h=v("div"),b(c,"class","units svelte-19yoq2g"),b(n,"class","svelte-19yoq2g"),b(h,"class","line-chart svelte-19yoq2g"),b(t,"class","container svelte-19yoq2g")},m(_,g){w(_,t,g),f(t,n),f(n,r),f(n,o),f(n,s),f(n,i),f(n,c),f(c,d),f(t,l),f(t,h),e[5](h)},p(_,[g]){g&2&&I(r,_[1]),g&1&&I(d,_[0])},i:L,o:L,d(_){_&&x(t),e[5](null)}}}function at(e,t=1){const n=e.length;return e.reduce((r,o)=>r+o/n,0)}const Bt=20,st=30,rt=30,z=40,Ft={temp:[60,80],co2:[300,1e3],humidity:[0,80]},Et=$t,O=mt(",.1~f");function jt(e,t,n){let r,{unit:o}=t,{data:s}=t,{name:i}=t;const c=s.map(m=>({val:m[i],time:m.time})),d=c.length,l=c.map(m=>m.val);O(at(l));const h=O(at(l.slice(-10)));O(ft(l)),O(pt(l));const _=c[_t(l)],g=c[dt(l)],[k,p]=X(s,m=>m[i]),a=Ft[i];a[0]>k&&(a[0]=k),a[1]<p&&(a[1]=p);const u=X(s,m=>m.time);ht(d),vt(()=>{const m=r.offsetWidth,q=r.offsetHeight,H=gt(u,[z,m-st]).nice(),P=yt(a,[q-rt,Bt]),lt=bt(H).ticks(8).tickSizeOuter(0),it=kt(P).ticks(q/40),ct=wt().curve(Et).x(y=>H(y.time)).y(y=>P(y.val)),N=xt("svg").attr("width",m).attr("height",q).attr("viewBox",[0,0,m,q]).attr("style","max-width: 100%; height: auto; height: intrinsic;");N.append("g").attr("transform",`translate(0,${q-rt})`).call(lt),N.append("g").attr("transform",`translate(${z},0)`).call(it).call(y=>y.select(".domain").remove()).call(y=>{y.selectAll(".tick line").clone().attr("x2",m-z-st).attr("stroke-opacity",.1),y.selectAll(".tick").style("opacity",.5)}).call(y=>y.append("text").attr("x",-z).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(o)),N.append("path").attr("fill","none").attr("stroke","currentColor").attr("stroke-width",1.5).attr("stroke-opacity",.65).attr("d",ct(c));const U=(y,ut)=>{const K=H(y.time),W=P(y.val),B=ut==="above",V=20*(B?1:-1),Q=2;N.append("line").attr("stroke","currentcolor").style("opacity",.3).attr("stroke-width",1).attr("x1",K).attr("x2",K).attr("y1",W+(B?-1:1)*Q).attr("y2",W-V+(B?1:-1)*Q),N.append("text").attr("x",K).attr("y",W-V).attr("text-anchor","middle").attr("alignment-baseline",B?"baseline":"hanging").attr("stroke-width",1).style("font-size","0.8rem").style("font-weight","300").text(O(y.val))};U(g,"below"),U(_,"above"),r.append(N.node())});function S(m){Ct[m?"unshift":"push"](()=>{r=m,n(2,r)})}return e.$$set=m=>{"unit"in m&&n(0,o=m.unit),"data"in m&&n(4,s=m.data),"name"in m&&n(1,i=m.name)},[o,i,r,h,s,S]}class T extends G{constructor(t){super();J(this,t,jt,Ot,R,{unit:0,data:4,name:1})}}function zt(e){let t,n,r=e[6].message+"",o;return{c(){t=v("p"),n=C("Something went wrong: "),o=C(r)},m(s,i){w(s,t,i),f(t,n),f(t,o)},p(s,i){i&2&&r!==(r=s[6].message+"")&&I(o,r)},i:L,o:L,d(s){s&&x(t)}}}function Dt(e){let t,n,r=D(e[5][0].time,!0)+"",o,s,i=D(ot(e[5]).time)+"",c,d,l,h,_,g,k,p;return l=new T({props:{data:e[5],name:"co2",unit:"ppm"}}),_=new T({props:{data:e[5],name:"temp",unit:"\u2109"}}),k=new T({props:{data:e[5],name:"humidity",unit:"%"}}),{c(){t=v("h3"),n=C("Time range: "),o=C(r),s=C(" - "),c=C(i),d=$(),F(l.$$.fragment),h=$(),F(_.$$.fragment),g=$(),F(k.$$.fragment)},m(a,u){w(a,t,u),f(t,n),f(t,o),f(t,s),f(t,c),w(a,d,u),E(l,a,u),w(a,h,u),E(_,a,u),w(a,g,u),E(k,a,u),p=!0},p(a,u){(!p||u&2)&&r!==(r=D(a[5][0].time,!0)+"")&&I(o,r),(!p||u&2)&&i!==(i=D(ot(a[5]).time)+"")&&I(c,i);const S={};u&2&&(S.data=a[5]),l.$set(S);const m={};u&2&&(m.data=a[5]),_.$set(m);const q={};u&2&&(q.data=a[5]),k.$set(q)},i(a){p||(A(l.$$.fragment,a),A(_.$$.fragment,a),A(k.$$.fragment,a),p=!0)},o(a){M(l.$$.fragment,a),M(_.$$.fragment,a),M(k.$$.fragment,a),p=!1},d(a){a&&x(t),a&&x(d),j(l,a),a&&x(h),j(_,a),a&&x(g),j(k,a)}}}function Ht(e){let t;return{c(){t=v("p"),t.textContent="Fetching data from office raspberry pi..."},m(n,r){w(n,t,r)},p:L,i:L,o:L,d(n){n&&x(t)}}}function Pt(e){let t,n,r,o,s,i,c,d,l,h,_,g,k,p={ctx:e,current:null,token:null,hasCatch:!0,pending:Ht,then:Dt,catch:zt,value:5,error:6,blocks:[,,,]};return Y(h=e[1],p),{c(){t=v("form"),n=v("label"),r=v("span"),r.textContent="Number of hours to pull:",o=$(),s=v("input"),i=$(),c=v("button"),c.textContent="Update",d=$(),l=qt(),p.block.c(),b(s,"type","number"),b(s,"min","1"),b(s,"max","24"),b(c,"type","submit"),b(n,"class","svelte-n92o7v")},m(a,u){w(a,t,u),f(t,n),f(n,r),f(n,o),f(n,s),Z(s,e[0]),f(n,i),f(n,c),w(a,d,u),w(a,l,u),p.block.m(a,p.anchor=u),p.mount=()=>l.parentNode,p.anchor=l,_=!0,g||(k=[tt(s,"input",e[4]),tt(t,"submit",e[2])],g=!0)},p(a,[u]){e=a,u&1&&et(s.value)!==e[0]&&Z(s,e[0]),p.ctx=e,u&2&&h!==(h=e[1])&&Y(h,p)||Lt(p,e,u)},i(a){_||(A(p.block),_=!0)},o(a){for(let u=0;u<3;u+=1){const S=p.blocks[u];M(S)}_=!1},d(a){a&&x(t),a&&x(d),a&&x(l),p.block.d(a),p.token=null,p=null,g=!1,St(k)}}}function Kt(e){return e*(9/5)+32}function ot(e){return e[e.length-1]}function D(e,t=!1){return t?nt("%a %b %e @ %I:%M %p")(e):nt("%I:%M %p")(e)}function Wt(e){const[t,n,r,o]=e.split(",").map(Number);if(!(t&&n&&r&&o))throw console.error("Can't parse line of data",e),new Error("Can't parse line of data");return{time:new Date(t*1e3),co2:n,temp:Kt(Number(r)),humidity:o}}const Gt=async e=>{const n=(await(await fetch(`https://wmadisonatelier.com/data/${e}`)).json()).map(Wt);return Nt(n,r=>r.time)};function Jt(e,t,n){let r=6,o=r,s;function i(d){d.preventDefault(),n(3,o=r)}function c(){r=et(this.value),n(0,r)}return e.$$.update=()=>{e.$$.dirty&8&&n(1,s=Gt(o))},[r,s,i,o,c]}class Rt extends G{constructor(t){super();J(this,t,Jt,Pt,R,{})}}function Tt(e){let t,n,r,o,s,i,c,d;return c=new Rt({}),{c(){t=v("main"),n=v("img"),o=$(),s=v("h1"),s.textContent="West Madison HomeBase",i=$(),F(c.$$.fragment),It(n.src,r=Mt)||b(n,"src",r),b(n,"alt","Svelte Logo"),b(n,"class","svelte-1epmnvv"),b(s,"class","svelte-1epmnvv"),b(t,"class","svelte-1epmnvv")},m(l,h){w(l,t,h),f(t,n),f(t,o),f(t,s),f(t,i),E(c,t,null),d=!0},p:L,i(l){d||(A(c.$$.fragment,l),d=!0)},o(l){M(c.$$.fragment,l),d=!1},d(l){l&&x(t),j(c)}}}class Ut extends G{constructor(t){super();J(this,t,null,Tt,R,{})}}new Ut({target:document.getElementById("app")});
